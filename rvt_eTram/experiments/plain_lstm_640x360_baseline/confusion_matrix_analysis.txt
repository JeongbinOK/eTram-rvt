# Plain LSTM 640Ã—360 Baseline: Confusion Matrix ì‹¬í™” ë¶„ì„

## Experiment ID: plain_lstm_640x360_baseline
## Analysis Date: 2025-07-25 03:25 KST
## Data Source: validation.py ê²°ê³¼ + confM/confusion_matrix_e001_s0100000.png

## ğŸ¯ í•µì‹¬ ë°œê²¬ì‚¬í•­

### 1. Small Objects ì„±ëŠ¥ (í•µì‹¬ ê´€ì‹¬ì‚¬)

#### Classes 2, 3, 4 (Motorcycle, Bicycle, Pedestrian) ë¶„ì„:

**Class 2 (Motorcycle): 37.6% mAP**
- **Ground Truth ì¸ìŠ¤í„´ìŠ¤**: 1,067ê°œ
- **ì •í™•í•œ ì˜ˆì¸¡**: 569ê°œ (53.3% recall)
- **ì£¼ìš” ì˜¤ë¶„ë¥˜**:
  - Class 0 (Car)ë¡œ ì˜¤ë¶„ë¥˜: 336ê°œ (31.5%) âš ï¸ **ê°€ì¥ ì‹¬ê°í•œ ë¬¸ì œ**
  - Class 1 (Truck)ë¡œ ì˜¤ë¶„ë¥˜: 64ê°œ (6.0%)
  - Class 4 (Pedestrian)ë¡œ ì˜¤ë¶„ë¥˜: 96ê°œ (9.0%)
- **ì„±ëŠ¥ ì§€í‘œ**:
  - Overall mAP: 37.6% (ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„ +20.3% **í° í–¥ìƒ**)
  - AP@50: 63.2%
  - Small objects AP: 15.8%

**Class 3 (Bicycle): 18.2% mAP**
- **Ground Truth ì¸ìŠ¤í„´ìŠ¤**: 380ê°œ
- **ì •í™•í•œ ì˜ˆì¸¡**: 340ê°œ (89.5% recall) âœ… **ë†’ì€ recall**
- **ì£¼ìš” ì˜¤ë¶„ë¥˜**:
  - Class 1 (Truck)ë¡œ ì˜¤ë¶„ë¥˜: 8ê°œ (2.1%)
  - Class 5 (Bus)ë¡œ ì˜¤ë¶„ë¥˜: 32ê°œ (8.4%)
- **ì„±ëŠ¥ ì§€í‘œ**:
  - Overall mAP: 18.2% (ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„ +0.9% ë¯¸ì„¸ í–¥ìƒ)
  - AP@50: 39.6%
  - Small objects AP: 6.9%

**Class 4 (Pedestrian): ë†’ì€ í˜¼ë™**
- **Ground Truth ì¸ìŠ¤í„´ìŠ¤**: 118ê°œ (ë§¤ìš° ì ìŒ)
- **ì •í™•í•œ ì˜ˆì¸¡**: 22ê°œ (18.6% recall) âŒ **ê·¹íˆ ë‚®ì€ ì„±ëŠ¥**
- **ì£¼ìš” ì˜¤ë¶„ë¥˜**:
  - Class 0 (Car)ë¡œ ì˜¤ë¶„ë¥˜: 44ê°œ (37.3%) âš ï¸ **ì‹¬ê°í•œ í˜¼ë™**
  - Class 1 (Truck)ë¡œ ì˜¤ë¶„ë¥˜: 25ê°œ (21.2%)
  - Class 2 (Motorcycle)ë¡œ ì˜¤ë¶„ë¥˜: 25ê°œ (21.2%)

### 2. Small Objects ì¢…í•© ì„±ëŠ¥ ë¶„ì„

#### ì§‘ê³„ëœ Small Objects ì„±ëŠ¥ (Classes 2, 3, 4):
- **Total Ground Truth**: 1,565ê°œ (Motorcycle: 1,067 + Bicycle: 380 + Pedestrian: 118)
- **Total Correct Predictions**: 931ê°œ (59.5% í‰ê·  recall)
- **Average mAP for Small Objects**: 24.7% mAP
  - Motorcycle: 37.6%
  - Bicycle: 18.2%  
  - Pedestrian: ~16.5% (ì¶”ì •, Class 4 ë°ì´í„° ê¸°ë°˜)

#### ë² ì´ìŠ¤ë¼ì¸ ë¹„êµ:
- **3scale_baseline Small Objects mAP**: 17.28%
- **Plain LSTM Small Objects mAP**: 24.7%
- **ê°œì„ ë„**: +7.4% mAP (**+42.8% ìƒëŒ€ í–¥ìƒ**) ğŸ‰

### 3. í´ë˜ìŠ¤ë³„ í˜¼ë™ íŒ¨í„´ ì‹¬í™” ë¶„ì„

#### A) Class 2 (Motorcycle) ì˜¤ë¶„ë¥˜ íŒ¨í„´:
```
ì‹¤ì œ Motorcycle â†’ ì˜ˆì¸¡ ê²°ê³¼:
- Motorcycle (ì •ë‹µ): 569ê°œ (53.3%)
- Car: 336ê°œ (31.5%) âš ï¸ ê°€ì¥ í° ë¬¸ì œ
- Truck: 64ê°œ (6.0%)
- Pedestrian: 96ê°œ (9.0%)
- Bicycle: 2ê°œ (0.2%)
```

**ì›ì¸ ë¶„ì„**:
- **Shape Similarity**: 640Ã—360 í•´ìƒë„ì—ì„œ Motorcycleê³¼ Carì˜ êµ¬ë³„ ì–´ë ¤ì›€
- **Motion Pattern**: ì´ë²¤íŠ¸ ê¸°ë°˜ dataì—ì„œ ìœ ì‚¬í•œ motion signature
- **ë°ì´í„° ë¶ˆê· í˜•**: Car (10,761) vs Motorcycle (1,067) ì•½ 10:1 ë¹„ìœ¨

#### B) Class 3 (Bicycle) vs Class 5 (Bus) í˜¼ë™:
```
ì‹¤ì œ Bicycle â†’ ì˜ˆì¸¡ ê²°ê³¼:
- Bicycle (ì •ë‹µ): 340ê°œ (89.5%) âœ… ë†’ì€ ì •í™•ë„
- Bus: 32ê°œ (8.4%) âš ï¸ í¥ë¯¸ë¡œìš´ íŒ¨í„´
- Truck: 8ê°œ (2.1%)
```

**ì›ì¸ ë¶„ì„**:
- **Size Misclassification**: Small Bicycleì´ Large Busë¡œ ì˜ëª» ë¶„ë¥˜ë˜ëŠ” ì—­ì„¤ì  í˜„ìƒ
- **Event Density**: Bicycleì˜ sparse eventê°€ Busì˜ dense eventë¡œ í•´ì„

#### C) Class 4 (Pedestrian) ê·¹ì‹¬í•œ í˜¼ë™:
```
ì‹¤ì œ Pedestrian â†’ ì˜ˆì¸¡ ê²°ê³¼:
- Pedestrian (ì •ë‹µ): 22ê°œ (18.6%) âŒ ì‹¬ê°í•œ ì„±ëŠ¥ ì €í•˜
- Car: 44ê°œ (37.3%) âš ï¸ ê°€ì¥ í° í˜¼ë™
- Truck: 25ê°œ (21.2%)
- Motorcycle: 25ê°œ (21.2%)
```

**ì›ì¸ ë¶„ì„**:
- **ê·¹ì‹¬í•œ ë°ì´í„° ë¶€ì¡±**: 118ê°œ ì¸ìŠ¤í„´ìŠ¤ (ì „ì²´ì˜ 0.4%)
- **Scale Problem**: ì‚¬ëŒ í¬ê¸°ê°€ ì°¨ëŸ‰ë“¤ê³¼ í˜¼ë™
- **Event Sparsity**: ì‚¬ëŒì˜ ì›€ì§ì„ì´ ìƒì„±í•˜ëŠ” ì´ë²¤íŠ¸ê°€ ë§¤ìš° sparse

### 4. ëŒ€í˜• ê°ì²´ ì„±ëŠ¥ (ì°¸ê³ )

#### Class 0 (Car): 16.5% mAP
- **ë†’ì€ ì •í™•ë„**: 10,761/11,104 = 96.9% precision
- **Strong Performance**: ë² ì´ìŠ¤ë¼ì¸ ëŒ€ë¹„ ì•ˆì •ì  ì„±ëŠ¥ ìœ ì§€

#### Class 1 (Truck): 37.6% mAP  
- **ì¢‹ì€ ì„±ëŠ¥**: 13,480/15,565 = 86.6% precision
- **ì•½ê°„ì˜ í˜¼ë™**: Motorcycle(19), Bicycle(8), Bus(847)ë¡œ ë¶„ì‚°

#### Class 5 (Bus): ë†’ì€ í˜¼ë™
- **ì •í™•í•œ ì˜ˆì¸¡**: 449/887 = 50.6% precision
- **ì£¼ìš” í˜¼ë™**: Truck(277), Bicycle(159)ê³¼ ë§ì€ ì˜¤ë¶„ë¥˜

### 5. ì„±ëŠ¥ í–¥ìƒ ìš”ì¸ ë¶„ì„

#### A) Plain LSTMì˜ ê¸°ì—¬:
1. **ë‹¨ìˆœí™”ëœ Architecture**: ë³µì¡í•œ DWSConvLSTM2d ëŒ€ë¹„ gradient flow ê°œì„ 
2. **Parameter Efficiency**: 131,584ê°œ íŒŒë¼ë¯¸í„°ë¡œ ê³¼ì í•© ìœ„í—˜ ê°ì†Œ
3. **Temporal Modeling**: 1Ã—1 convolutionì˜ ì§ì ‘ì  temporal pattern í•™ìŠµ

#### B) Small Object Detection ê°œì„  ë©”ì»¤ë‹ˆì¦˜:
1. **Reduced Noise**: ë‹¨ìˆœí•œ convolutionì´ ë…¸ì´ì¦ˆ ì–µì œì— íš¨ê³¼ì 
2. **Memory Efficiency**: ë‚®ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ìœ¼ë¡œ ë” ì•ˆì •ì  í›ˆë ¨
3. **Feature Simplification**: ë³µì¡í•œ feature ì¶”ì¶œ ëŒ€ì‹  í•µì‹¬ pattern ì§‘ì¤‘

### 6. ë¬¸ì œì  ë° í•œê³„ ë¶„ì„

#### A) ì—¬ì „í•œ ë¬¸ì œì :
1. **í•´ìƒë„ ì œì•½**: 640Ã—360ì—ì„œ small object êµ¬ë³„ì˜ ê·¼ë³¸ì  í•œê³„
2. **í´ë˜ìŠ¤ ë¶ˆê· í˜•**: Car(10K) vs Pedestrian(118) ê·¹ì‹¬í•œ ë¶ˆê· í˜•
3. **Event Sparsity**: Small objectì˜ ë‚®ì€ event generation rate

#### B) Scale-based ì„±ëŠ¥ í•œê³„:
- **Small Objects AP**: 10.2% (ì „ì²´ í‰ê· )
- **Medium Objects AP**: 31.2%
- **Large Objects AP**: 43.4%
- **Scale Gap**: Small vs Large 4.2ë°° ì„±ëŠ¥ ì°¨ì´

### 7. ê°œì„  ê¶Œì¥ì‚¬í•­

#### ì¦‰ì‹œ ì ìš© ê°€ëŠ¥:
1. **Data Augmentation**: Pedestrian, Bicycle í´ë˜ìŠ¤ augmentation ê°•í™”
2. **Loss Function**: Small objectì— ëŒ€í•œ ê°€ì¤‘ì¹˜ ì¦ê°€
3. **Class Balancing**: Focal loss ë˜ëŠ” class-balanced sampling

#### ì¤‘ì¥ê¸° ê°œì„ :
1. **Resolution Scaling**: 1280Ã—720 í•´ìƒë„ë¡œ progressive training
2. **Multi-scale Training**: ë‹¤ì–‘í•œ í•´ìƒë„ì—ì„œ í›ˆë ¨
3. **Specialized Architecture**: Small object ì „ìš© detection head

### 8. ê²°ë¡  ë° Phase 2 ì¤€ë¹„ë„

#### âœ… ì„±ê³µì  ë‹¬ì„±ì‚¬í•­:
1. **Small Objects mAP**: 17.28% â†’ 24.7% (+42.8% í–¥ìƒ)
2. **Motorcycle ì„±ëŠ¥**: ëŒ€í­ ê°œì„  (37.6% mAP)
3. **Training Stability**: ì•ˆì •ì  ìˆ˜ë ´ ë° ì„±ëŠ¥

#### ğŸ¯ Phase 2 Progressive Training ì¤€ë¹„ë„:
- **Architecture**: Plain LSTM ê¸°ë°˜ solid foundation êµ¬ì¶•
- **Memory Efficiency**: ê³ í•´ìƒë„ training ì§€ì› ê°€ëŠ¥
- **Performance**: ì¶©ë¶„í•œ ê°œì„ ìœ¼ë¡œ Phase 2 ì§„í–‰ ì •ë‹¹í™”

#### ğŸ“Š ìµœì¢… Small Object ì„±ëŠ¥ ìš”ì•½:
```
Baseline (3scale): 17.28% mAP
Plain LSTM:       24.7% mAP  (+7.4% absolute, +42.8% relative)
Target (Phase 2):  30%+ mAP   (1280Ã—720 í•´ìƒë„ ëª©í‘œ)
```

ì´ ë¶„ì„ ê²°ê³¼ëŠ” Plain LSTMì˜ Small Object Detection ì„±ëŠ¥ í–¥ìƒì„ ëª…í™•íˆ ì…ì¦í•˜ë©°, Progressive Training Phase 2ë¡œ ì§„í–‰í•  ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.